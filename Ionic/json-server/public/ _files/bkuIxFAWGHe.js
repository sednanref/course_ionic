if (self.CavalryLogger) { CavalryLogger.start_js(["lqQVK"]); }

__d('MultiChatController',['AsyncSignal','AsyncRequest','ChatOpenTab','Form','MercuryIDs','MercuryLocalIDs','MercuryThreadIDMap','MercuryViewer','MercuryServerDispatcher','XAssociateGroupThreadController','XGroupSideConversationCreateController','MercuryThreads','MercuryDispatcher'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h=c('MercuryThreadIDMap').get(),i=c('MercuryThreads').get(),j=c('MercuryDispatcher').get(),k=c('XAssociateGroupThreadController').getURIBuilder().getURI().toString(),l=c('XGroupSideConversationCreateController').getURIBuilder().getURI().toString();function m(){}Object.assign(m,{subscribe:function(o,p){o.subscribe('confirm',function(){this.createGroupThreadFromChooserDialog(o,p);}.bind(this));},subscribeFromPost:function(o,p){o.subscribe('confirm',function(){this.createGroupPostThreadFromChooserDialog(o,p);}.bind(this));},createGroupPostThreadFromChooserDialog:function(o,p){var q=c('Form').serialize(o.getRoot()),r=JSON.parse(q.profileChooserItems),s=Object.keys(r).filter(function(t){return !!r[t];});m.createThreadForFBIDs(s);new (c('AsyncRequest'))().setURI(l).setData({post_id:p}).send();o.hide();},createGroupThreadFromChooserDialog:function(o,p){var q=c('Form').serialize(o.getRoot()),r=JSON.parse(q.profileChooserItems),s=[];for(var t in r)if(r[t])s.push(t);var u=m.createThreadForFBIDs(s),v=j.subscribe('update-thread-ids',function(w,x){for(var y in x)if(x[y]==u){var z=i.getThreadMetaNow(u),aa=h.getServerIDFromClientIDNow(u);if(z&&!z.is_canonical&&aa)c('MercuryServerDispatcher').trySend(k,{group_id:p,thread_id:aa});new (c('AsyncSignal'))('/ajax/groups/chat/log',{group_id:p,message_id:y}).send();j.unsubscribe(v);break;}});o.hide();},createThreadForTokens:function(o){var p=c('MercuryViewer').getID();if(!o.length)return;o=o.filter(function(r){return r!==p;});var q;if(o.length===0){return;}else if(o.length===1){q=c('MercuryIDs').getThreadIDFromParticipantID(o[0]);c('ChatOpenTab').openThread(q,'ChatTabView');}else{q=c('MercuryLocalIDs').generateThreadID();o.unshift(p);i.createNewLocalThread(q,o);c('ChatOpenTab').openThread(q,'MultiChatController');}return q;},createThreadForFBIDs:function(o){var p=[];for(var q=0;q<o.length;q++)p.push("fbid:"+o[q]);return m.createThreadForTokens(p);}});var n={};n[k]={mode:c('MercuryServerDispatcher').IMMEDIATE};c('MercuryServerDispatcher').registerEndpoints(n);f.exports=m;},null);
__d('ProfileChooserSelectionRequiredUtils',['Button'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h={initButtonDisabler:function(i,j){function k(){c('Button').setEnabled(j,!!i.getCheckedCount());}i.subscribe('updateCheckableCount',k);k();},initDialogConfirmCheck:function(i){i.subscribe('confirm',function(j,k){return c('Button').isEnabled(k);});}};f.exports=h;},null);
__d('ProfileChooserUtils',['CSS','DOM'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h={listenForSelectionLimit:function(i,j,k,l){i.subscribe('updateCheckableCount',function(m,n){c('CSS').conditionClass(j,'limitNotReached',n.count<l);c('DOM').setContent(k,n.count);});}};f.exports=h;},null);